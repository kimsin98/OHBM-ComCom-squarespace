<p>By <a href="../contributors.html"><span style="color: rgb(17, 85, 204)">Claude Bajada</span></a>, <a href="https://www.cbs.mpg.de/person/simonhofmann/371395"><span style="color: rgb(17, 85, 204)">Simon M. Hofmann</span></a> and <a href="../contributors.html"><span style="color: rgb(17, 85, 204)">Ilona Lipp</span></a><br>Edited by: <a href="https://sites.google.com/site/yeoyeo02/home"><span style="color: rgb(17, 85, 204)">Thomas Yeo</span></a> and <a href="https://connects.catalyst.harvard.edu/Profiles/display/Person/65562"><span style="color: rgb(17, 85, 204)">Lisa Nickerson</span></a></p>
<p>Machine learning, deep learning and artificial intelligence are terms that currently appear everywhere; in the media, in job adverts… and at neuroimaging conferences. Machine learning is often portrayed as a mystical black box that will either solve all our problems in the future or replace us in our jobs. In this blog post, we discuss what the term machine learning actually means, what methods it encompasses, and how these methods can be applied to brain imaging analysis. Doing this, we refer to the OHBM OnDemand material, which contains some great videos explaining machine learning methodology and we provide examples for how it has been used in a variety of applications. If you are curious about machine learning tools, but are not really sure whether you want to jump on the bandwagon, then we hope that this post is right for you and will help you get started.</p>
<p><span style="font-weight: 700">What is machine learning?</span></p>
<p>Machine learning is a broad term that goes beyond deep learning and incorporates many other methods that are discussed in this post. Many of these methods you may already be familiar with and have heard about in the context of classical statistics, such as linear regression. While machine learning ‘is built on the foundations of statistics and has absorbed much of its philosophy and many of its techniques over the years’ (<a href="https://www.ics.uci.edu/~welling/publications/papers/WhyMLneedsStatistics.pdf"><span style="color: rgb(17, 85, 204)">Max Welling, 2015</span></a>), a main focus of machine learning lies in generalization, i.e. finding patterns in data by training a computational model such that it can predict unseen data of the same or similar nature. Here, a balance between “overfitting” (fitting a model that is too complex and will only work well for the data used to train it) and “underfitting” (fitting a model that is too simple and works poorly even with the data used to train it) needs to be found, aiming at high sensitivity and specificity when applied to new cases. This is generally attempted by splitting the data into various sets, training model parameters on one set, choosing the best model by evaluating it in another set, and testing it in yet another set. Sometimes, the term “statistical learning” is used for machine learning methods that have their foundation in statistics. <a href="http://www-bcf.usc.edu/~gareth/ISL/"><span style="color: rgb(17, 85, 204)">Introduction to statistical learning</span></a> and <a href="https://web.stanford.edu/~hastie/ElemStatLearn/"><span style="color: rgb(17, 85, 204)">The Elements of statistical learning</span></a> are two great textbooks introducing some important concepts.</p>
<p><span style="font-weight: 700">What about Artificial Intelligence? Is that something different?</span></p>
<p>Artificial Intelligence is a high-level, conceptual term that describes the movement to emulate “natural intelligence” in machines. Machine learning can be thought of as one set of statistical tools that can make machines more “intelligent”.  </p>
<p><span style="font-weight: 700">What types of methods are there?</span></p>
<p>The most popular machine learning techniques applied to neuroimaging can be split into two general groups: supervised and unsupervised learning. Supervised learning requires labelled data (e.g., data that has been labelled, classified, or categorized), whilst unsupervised methods detect patterns in unlabelled data. Different machine learning methods also differ with regard to their complexity. Both types of machine learning approaches can range from fairly simple linear models to much more complicated, non-linear, algorithms. The more complex the models get, the more computational power is required.</p>
<p>Even though machine learning has been around for a long time, it has experienced a recent boom. In his OHBM OnDemand video, Vince Calhoun (<a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/116076"><span style="color: rgb(17, 85, 204)">6:30 min</span></a>) explains why: it is not only because more and more data are available, but also because there has been an immense improvement in computational power (note that training neural networks can sometimes still take weeks!) and in better algorithms being developed and implemented in open source tools.</p>
<p>Below we will discuss some important methods that deploy both supervised and unsupervised learning. We will also discuss some approaches that are unique to neuroimaging (such as multivoxel pattern analysis).</p>
<p><span style="font-weight: 700">Supervised Learning</span></p>
<p>As described by Christophe Phillips in the OHBM 2017 course on pattern recognition (<a href="https://www.pathlms.com/ohbm/courses/5158/sections/7784/video_presentations/75823"><span style="color: rgb(17, 85, 204)">4:34 min</span></a>), the idea of supervised learning is to train a machine to find a mapping between observed data, such as your fMRI images, and an explanatory variable, which could be a disease label or a cognitive score. We can then find new, unlabeled subjects and predict the disease label or cognitive score.</p>
<p>Christophe further explains (<a href="https://www.pathlms.com/ohbm/courses/5158/sections/7784/video_presentations/75823"><span style="color: rgb(17, 85, 204)">7:10 min</span></a>) that supervised machine learning problems can be further subdivided into discrete classification predictions and continuous, or regression, predictions. Either way, supervised learning (<a href="https://www.pathlms.com/ohbm/courses/5158/sections/7784/video_presentations/75823"><span style="color: rgb(17, 85, 204)">10:50 min</span></a>) ultimately relies on a mapping function between input and target variables, the specification of the shape of this function and the optimization of its parameters. The following are some examples of various commonly used algorithms:</p>
<p><span style="font-weight: 700">Linear Regression</span></p>
<p>Most of you are familiar with linear regression as a classical statistical technique. However, this old staple has refashioned itself as a supervised learning technique. We can think of regression as a predictive technique that uses one (or many) features in order to predict a response as one continuous value (<a href="https://www.pathlms.com/ohbm/courses/5158/sections/7784/video_presentations/75823"><span style="color: rgb(17, 85, 204)">7:35 min</span></a>). The main difference between using regression as a standard statistical tool and as a machine learning tool is that in machine learning we test the predictive power of the linear model on unseen data that did not contribute to the training of the model.</p>
<p><span style="font-weight: 700">Logistic Regression</span></p>
<p>The idea behind logistic regression is, at its root, exactly the same as linear regression. The only difference is the function that is fitted to the data. While in linear regression we fit a line (or some generalisation of it in n dimensions – e.g, a plane or a hyperplane), in logistic regression we fit a logistic function. The logistic function is that “S-shaped” curve that often pops up in many biological sciences. The logistic function has the very nice property of being bounded (often these boundaries are set to 0 and 1) and hence can be used to express a probability. By having a cut-off, usually half way, we can use logistic regression to categorise our sample, for example into patients and controls.</p>
<p><span style="font-weight: 700">Support Vector Machines (SVMs):</span></p>
<p>Support vector machines (SVM) are a type of classification algorithms, where the aim is to draw a decision (or classification) boundary between sets of data points, so as to maximize the “separation” (or margin) between the sets. While this sounds fairly straightforward, it is often the case that the data points are not easily separable by a line or plane, for instance, if two circles are embedded into one another. Kernel SVMs use “kernels” to transform the data into an alternative space where it might become much easier to separate the two instances. Christophe describes kernels and SVMs <a href="https://www.pathlms.com/ohbm/courses/5158/sections/7784/video_presentations/75823"><span style="color: rgb(17, 85, 204)">(from 17:00 min</span></a>) in his introductory lecture.<span style="color: rgb(152, 0, 0)"> </span>There are additional parameters such as regularisation parameters, gamma and the margin, that are important to define how well the line separates the training data. For a more generic discussion of SVMs, this <a href="https://medium.com/machine-learning-101/chapter-2-svm-support-vector-machine-theory-f0812effc72"><span style="color: rgb(17, 85, 204)">medium post</span></a> does a good job at explaining the basics.</p>
<p><span style="font-weight: 700">Deep Learning:</span></p>
<p>Deep learning is one of the most talked about classes of machine learning algorithms and the one that most excites the public’s mind. Despite all the hype, deep learning models are often treated as a black box, since their input-output-mapping is both analytically and intuitively hard to grasp. In Vince Calhoun’s <a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/116076"><span style="color: rgb(17, 85, 204)">OHBM educational lecture</span></a> on deep learning approaches applied to neuroimaging, he explains that the foundation of deep learning lies in artificial neural networks. In fact, despite experiencing a boom in popularity in recent years, neural network modelling dates back to the 1950s when there was a lot of interest in creating a mathematical model of a biological neuron (<a href="https://www.cell.com/neuron/fulltext/S0896-6273(17)30509-3"><span style="color: rgb(17, 85, 204)">This paper</span></a> by Hassabis et al. (2017) provides a stimulating discussion on the relationship between neuroscience and artificial intelligence). This neuronal model became known as a perceptron. The most basic type of network is the multilayer perceptron (MLP), with artificial neurons (perceptrons) organised in hierarchical layers. The input to the network is propagated layer-by-layer, first through activation-functions in each node, and then through connections (weights) to the successive layer. The “deep” part of deep learning refers to the number of multiple hidden layers, i.e. the layers between the input and output of the network. In recent years, computational advances have allowed the training of deeper and deeper networks. Some types of neural networks that Vince describes are Restricted Boltzmann Machines (<a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/116076"><span style="color: rgb(17, 85, 204)">7:10 min</span></a>), deep belief networks (<a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/116076"><span style="color: rgb(17, 85, 204)">8:20 min</span></a>), convolutional neural networks (<a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/116076"><span style="color: rgb(17, 85, 204)">16:35 min</span></a>) and others.</p>
<p>As with other supervised learning algorithms, deep learning needs a training set and a test set. Furthermore, the more layers you have, the more (labeled) data and computational resources you usually need. In fact, deep learning increased in popularity once computing power increased to the point that deep networks were feasible, particularly after the availability of graphical processing units (GPUs), which are hardware chips originally developed for accelerated processing of digital videos and graphic rendering (<a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/116076"><span style="color: rgb(17, 85, 204)">3:10 min</span></a>).</p>
<p><span style="font-weight: 700">Multi-voxel pattern analysis (MVPA): A common application of ML in brain imaging?</span></p>
<p>In the classical analysis of structural and functional MRI, i.e. the application of a general linear model (GLM), each voxel is considered separately. Due to its linear equations, the approach is mathematically neat and tractable, however, this “massively univariate” approach disregards the interdependencies between multiple voxels (see Robert Cox’s talk about fMRI analysis methods at <a href="https://www.pathlms.com/ohbm/courses/5158/sections/7756/video_presentations/75744"><span style="color: rgb(17, 85, 204)">4:16 min</span></a>, Mike Pratt’s talk  at <a href="https://www.pathlms.com/ohbm/courses/5158/sections/7756/video_presentations/75758"><span style="color: rgb(17, 85, 204)">0:35 min</span></a>). In light of dynamic brain processes that engage entire networks of the brain, the independence assumption of single voxels is controversial. In order to address this issue, a more recent class of statistical models, known as multi-voxel pattern analysis (MVPA), has been introduced to account for the joint contribution or ”combinatorial code“ of multiple voxels across the brain to the phenomenon of interest (see Janaina Mourão-Miranda’s talk at <a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/116079"><span style="color: rgb(17, 85, 204)">6:08 min</span></a>). That is, MVPA describes a class of pattern-recognition techniques, which are presented in Mike Pratt’s talk on MVPA <a href="https://www.pathlms.com/ohbm/courses/5158/sections/7756/video_presentations/75758"><span style="color: rgb(17, 85, 204)">(3:33 min)</span></a>, and in a session devoted to MVPA at OHMB 2017 (the corresponding videos can be found <a href="https://www.pathlms.com/ohbm/courses/5158/sections/7784"><span style="color: rgb(17, 85, 204)">here</span></a>).</p>
<p>MVPA draws from algorithmic strategies commonly used in machine learning. First, the data are split into a training set and test set. Then the classifier of choice (e.g., SVM) is trained on the former to discriminate various multi-voxel patterns corresponding to the experimental conditions, and validated on the latter. Validation is done by using the trained model to predict  the conditions in the test set based on the multi-voxel input, which is often referred to as decoding (see Bertrand Thirion from <a href="https://www.pathlms.com/ohbm/courses/5158/sections/7784/video_presentations/75961"><span style="color: rgb(17, 85, 204)">5:38 min</span></a>, and Mike Pratt’s talk at <a href="https://www.pathlms.com/ohbm/courses/5158/sections/7756/video_presentations/75758"><span style="color: rgb(17, 85, 204)">8:04 min</span></a>). In decoding, we try to predict from multi-scale neural processes its representational content, such as percepts or cognitive states, mostly induced by experimental conditions (Pratt’s talk at <a href="https://www.pathlms.com/ohbm/courses/5158/sections/7756/video_presentations/75758"><span style="color: rgb(17, 85, 204)">11:55 min</span></a>). Classifiers can be linear or non-linear in nature, each having their own limitations. Linear classifiers (e.g., linear discriminant analysis, LDA) are considered easier to train and to interpret, however, their sensitivity depends on the individual contribution of each voxel in the observed pattern (see Jo Etzel’s talk at <a href="https://www.pathlms.com/ohbm/courses/5158/sections/7784/video_presentations/75949"><span style="color: rgb(17, 85, 204)">18:00 min</span></a>). Whereas non-linear classifiers (e.g., artificial neural networks, see Vince Calhoun’s <a href="https://www.pathlms.com/ohbm/courses/5158/sections/7784/video_presentations/75965"><span style="color: rgb(17, 85, 204)">talk</span></a>) are able to find more complex relationships between patterns of voxels, they require training  on large datasets.</p>
<p>The term MVPA was coined by <a href="https://www.ncbi.nlm.nih.gov/pubmed/16899397"><span style="color: rgb(17, 85, 204)">Norman, Polyn, Detre, and Haxby (2006)</span></a>, who introduced it within the framework of fMRI analysis. However, considering a broader definition of the term, most of the methods that MVPA encompases are not restricted to fMRI and can be equally applied to structural imaging (e.g., <a href="https://link.springer.com/article/10.1007%2Fs11682-017-9699-6"><span style="color: rgb(17, 85, 204)">Zhang et al., 2018</span></a>; or <a href="https://www.sciencedirect.com/science/article/pii/S1053811917306407"><span style="color: rgb(17, 85, 204)">Cole et al., 2017</span></a>; and see James Cole’s <a href="https://www.pathlms.com/ohbm/courses/5158/sections/7802/video_presentations/76044"><span style="color: rgb(17, 85, 204)">talk</span></a> at OHBM 2017).</p>
<p><span style="font-weight: 700">Unsupervised Learning </span></p>
<p>In supervised learning, in addition to the input data (for example, fMRI images), we also need the ‘ground-truth’ output, which may be labels (e.g. healthy vs condition) or scores (some sort of cognitive or behavioural scores). However, frequently we either do not have appropriate labels, or the labels that we do have are unreliable, for example, in psychiatric imaging, as explained by Verena Kebets <a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/116080"><span style="color: rgb(17, 85, 204)">in her video</span></a>.<span style="color: rgb(152, 0, 0)"> </span>In this case, unsupervised machine learning methods open new doors.</p>
<p><span style="font-weight: 700">Clustering:</span></p>
<p>In the neuroimaging community, the unsupervised machine learning technique of clustering is best known by its application to estimating brain parcellations. Brain parcellation is not a new problem and neither is it one that necessarily involves machine learning. All neuroimagers have heard of the 19th century neuroanatomist Korbinian Brodmann who labeled brain regions according to their cytoarchitecture -- the original brain mapping! As Simon Eickhoff explains in last year’s <a href="https://www.pathlms.com/ohbm/courses/8246/sections/12540/video_presentations/115825"><span style="color: rgb(17, 85, 204)">keynote</span></a>, cytoarchitecture is not the only feature by which to parcellate the brain; there are others, such as receptor architecture, cortical myelin structure, and connectivity structure.</p>
<p>Unsupervised clustering methods are ideal for data with known differences based on features of interest where we want to automatically group brain regions according to these features. The simplest, and probably most widely used technique available, is k-means clustering. In neuroimaging, this is done by creating a feature vector per voxel in a region of interest, for example, structural or functional connectivity information. These voxels can now be thought of as points in an n-dimensional feature space. The k-means algorithm then attempts to maximize within-group similarity. Unfortunately, k-means clustering requires an a priori knowledge of the amount of groupings (k) one is interested in (although there are some iterative techniques to try to establish the number of k). </p>
<p>Other approaches to clustering, such as hierarchical clustering or spectral clustering, have the same basic idea of splitting up data (in this case brain voxels) into discrete groups, or parcels, but have slightly different assumptions or tricks. For example, hierarchical clustering assumes that the data have a hierarchical structure and so you could split the brain into two groups, each of which can be split into another two groups, until we reach the level of individual voxels. Or you could start from individual voxels and work your way up. On the other hand, spectral clustering has an additional step (the spectral transformation), which allows you to disregard weak similarity. Sarah Genon, in her <a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/115843"><span style="color: rgb(17, 85, 204)">educational course</span></a> lecture, describes how to perform such analyses using diffusion MRI data.</p>
<p><span style="font-weight: 700">Laplacian EigenMaps / Diffusion Embedding</span>:</p>
<p>Sometimes you may not be interested in grouping voxels into a fixed number  of parcels, but rather explore the relationship of voxels in a region of interest based on a feature of interest. In his <a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/115846"><span style="color: rgb(17, 85, 204)">educational talk</span></a>,<span style="color: rgb(152, 0, 0)"> </span>Daniel Margulies describes techniques that can be used to investigate the connectopies, or connectivity maps, of the brain. The initial approach is similar to the one described above, where you create a feature vector for every voxel in the brain. These features are then compared to each other using a measure of similarity to create a similarity, or affinity, matrix. This matrix is then decomposed and new vectors are obtained which describe the principal gradients of similarity across a region of interest, or indeed the whole brain. <a href="https://www.pathlms.com/ohbm/courses/8246/sections/12540/video_presentations/115833"><span style="color: rgb(17, 85, 204)">Daniel’s keynote</span></a> describes how such types of analyses can be used to elucidate topographic principles of macroscale cortical connectivity. </p>
<p><span style="font-weight: 700">Associative models:</span></p>
<p>Associative models, such as partial least squares (PLS) or canonical correlation analysis (CCA), are not exactly supervised or unsupervised. In supervised learning we generally have a multivariate input (e.g. brain images) and a univariate output (labels). In unsupervised learning, we only have one set of multivariate input data, such as the connectivity information for brain parcellation. In PLS or CCA, we want to discover relationships (associations) between two sets of multivariate inputs (e.g., brain images and behavioral/clinical scores).</p>
<p>As Janaina Mourao-Miranda explains in her video (<a href="https://www.pathlms.com/ohbm/courses/5158/sections/7784/video_presentations/75964"><span style="color: rgb(17, 85, 204)">2:25 min</span></a>), psychiatric conditions often have unreliable labels. To deal with this, she uses associative models (e.g., PLS), trying to find a linear combination of neuroimaging predictors that are most strongly associated with  a linear combination of multivariate clinical and behavioural data. This provides a data-driven way to generate summary labels that can possibly shed new light on clinical conditions.</p>
<p>It is possible to do significance testing on associative models to make inferences. Valeria Kebets describes (<a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/116080"><span style="color: rgb(17, 85, 204)">11:20 min</span></a>) how to perform permutation tests in order to determine which components are significant, how to determine whether components are expressed differently across groups, and, finally, which variables drive the extracted components. In her video, Janaina also goes into the details about how her group applies a multiple hold-out validation framework in partial least squares analysis (<a href="https://www.pathlms.com/ohbm/courses/5158/sections/7784/video_presentations/75964"><span style="color: rgb(17, 85, 204)">16:50 min</span></a>). </p>
<p><span style="font-weight: 700">What do I need to consider when using machine learning tools for brain imaging analysis?</span></p>
<p>As explored in the previous paragraphs, machine learning techniques open many doors for brain imaging. They can help make predictions that depend on complex interactions, help find patterns in our data that we have been previously unaware of, and also automate time consuming manual tasks, such as segmentations (e.g. see <a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/115838"><span style="color: rgb(17, 85, 204)">Pim Moeskop’s video</span></a>). However, there are also pitfalls that must be considered. First, the more complex and powerful machine learning techniques really need large datasets. In his video, Andrew Doyle (<a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/115827"><span style="color: rgb(17, 85, 204)">25:30 min</span></a>) discusses how neuroimaging applications differ from classical image processing problems, with brain imaging data usually being very large and high-dimensional data, while sample sizes are comparatively small. For some applications (e.g. image segmentation or MVPA), smaller sample sizes may not be a big issue, but for others (such as patient classification) they may. <a href="https://www.sciencedirect.com/science/article/pii/S105381191600210X"><span style="color: rgb(17, 85, 204)">A recent publication by Arbabshirani et al. (2018)</span></a> explores the reason for why making individual predictions from brain imaging data is challenging. <a href="https://www.sciencedirect.com/science/article/pii/S1053811917305311"><span style="color: rgb(17, 85, 204)">Another paper by Varoquaux (2018)</span></a> focuses on the challenges with model cross validation on small sample sizes.</p>
<p>Of course, the noisier the data, the more data points are needed, and brain imaging data are renowned to be noisy. Additionally, if no reliable labels can be provided, the best supervised learning algorithms will not be able to succeed. Another problem, in particular with the more complex methods such as deep learning, is the challenge of assessing how biologically meaningful the resulting models are. Recent efforts have gone into better understanding and evaluating what is actually happening in the deep layers (e.g. watch <a href="https://www.pathlms.com/ohbm/courses/8246/sections/12542/video_presentations/115841"><span style="color: rgb(17, 85, 204)">Alex Binder’s video</span></a>). However, resulting models may not teach us anything about biological or pathological mechanisms, and they may actually represent biases that exist in our training data, limiting their generalisability to other data. For example, this year’s <a href="ohbm-replication-award-qa-with-chris-gorgolewski.html"><span style="color: rgb(17, 85, 204)">replication award</span></a> was awarded to a study that showed lack of generalisability of some published models. </p>
<p>Until these issues are fully resolved by the community, as individual researchers the best we can do is to understand the algorithms we are using and their limitations. That way we can choose the most suitable techniques, and rigorously apply them on suitable sample sizes and avoid overfitting. Luckily, there is a vast amount of online resources on machine learning techniques, including textbooks <a href="https://www.springer.com/de/book/9780387310732"><span style="color: rgb(17, 85, 204)">(e.g. Bishop, 2006</span></a>), Andrew Ng’s famous Coursera courses on <a href="https://www.coursera.org/learn/machine-learning"><span style="color: rgb(17, 85, 204)">machine learning</span></a> and <a href="https://www.coursera.org/specializations/deep-learning"><span style="color: rgb(17, 85, 204)">deep learning</span></a>, and online blogs and forums. Numerous papers from the MRI community provide <a href="https://www.sciencedirect.com/science/article/pii/S1053811910014163"><span style="color: rgb(17, 85, 204)">overviews of machine learning tools for neuroimaging</span></a>, or more specific examples, such as <a href="https://gigascience.biomedcentral.com/articles/10.1186/2047-217X-3-28"><span style="color: rgb(17, 85, 204)">how machine learning is shaping cognitive neuroimaging</span></a>, and <a href="https://www.sciencedirect.com/science/article/pii/S1053811908012263"><span style="color: rgb(17, 85, 204)">how to use machine learning classifiers for fMRI data</span></a>. OHBM’s <a href="https://www.pathlms.com/ohbm"><span style="color: rgb(17, 85, 204)">OnDemand</span></a> has an extensive archive of videos from education courses and talks on machine learning applications for neuroimaging that we’ve included in this article and, we also expect many exciting new educational and symposium talks on the use of machine learning techniques in brain imaging at this year’s OHBM in Rome, so watch out for those, too!</p>
